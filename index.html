<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR Camera App</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –¢–∏–º—á–∞—Å–æ–≤—ñ —Å—Ç–∏–ª—ñ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - –¥–æ–¥–∞—î–º–æ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å */
        .test-camera-container {
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            background: white !important;
            padding: 40px !important;
            border-radius: 16px !important;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3) !important;
            z-index: 9999 !important;
            text-align: center !important;
            max-width: 400px !important;
            width: 90vw !important;
        }
        
        .test-camera-button {
            background: #01F55F !important;
            color: black !important;
            border: none !important;
            padding: 16px 32px !important;
            border-radius: 999px !important;
            font-size: 18px !important;
            cursor: pointer !important;
            width: 100% !important;
            margin: 16px 0 !important;
            font-weight: 600 !important;
            position: relative !important;
            z-index: 10000 !important;
        }
        
        .test-camera-button:hover {
            background: #000 !important;
            color: white !important;
        }
        
        .test-camera-button:active {
            transform: scale(0.98) !important;
        }
        
        .test-hidden-input {
            display: none !important;
            visibility: hidden !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        .test-preview {
            max-width: 100% !important;
            max-height: 200px !important;
            border-radius: 8px !important;
            margin: 16px 0 !important;
            display: none !important;
        }
        
        .test-status {
            margin: 16px 0 !important;
            padding: 8px !important;
            border-radius: 8px !important;
            background: #f0f0f0 !important;
            color: #333 !important;
        }
    </style>
</head>
<body class="camera-page">
    
    <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–∏—Ç–∏ (—ñ—Å–Ω—É—é—á–∞) -->
    <button id="close-camera" class="btn btn-secondary camera-close" onclick="window.location.href='words.html'">
        <img src="icons/Close_LG.svg" alt="Close" width="24" height="24">
    </button>
    
    <!-- –¢–µ—Å—Ç–æ–≤–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ –≤–∏—Å–æ–∫–∏–º z-index -->
    <div class="test-camera-container">
        <div style="font-size: 48px; margin-bottom: 16px;">üì∑</div>
        <h2 style="margin-bottom: 16px;">OCR Scanner</h2>
        <p style="color: #666; margin-bottom: 24px;">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è —Ñ–æ—Ç–æ</p>
        
        <!-- –¢–ï–°–¢–û–í–ê –∫–Ω–æ–ø–∫–∞ –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–º –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º -->
        <button id="capture" class="test-camera-button" onclick="console.log('BUTTON CLICKED!'); document.getElementById('camera-input').click();">
            üì∏ –ó—Ä–æ–±–∏—Ç–∏ —Ñ–æ—Ç–æ
        </button>
        
        <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è -->
        <button onclick="alert('–¢–µ—Å—Ç –∫–ª—ñ–∫—É –ø—Ä–∞—Ü—é—î!'); document.getElementById('camera-input').click();" 
                style="background: red; color: white; border: none; padding: 10px; margin: 5px; cursor: pointer;">
            –¢–ï–°–¢ –ö–õ–Ü–ö
        </button>
        
        <!-- –ü—Ä–∏—Ö–æ–≤–∞–Ω–∏–π input -->
        <input type="file" 
               id="camera-input" 
               class="test-hidden-input"
               accept="image/*" 
               capture="environment"
               onchange="console.log('FILE SELECTED:', this.files[0]);">
        
        <!-- –ü—Ä–µ–≤'—é -->
        <img id="image-preview" class="test-preview" alt="–ü—Ä–µ–≤'—é">
        
        <!-- –°—Ç–∞—Ç—É—Å -->
        <div id="status" class="test-status">–ì–æ—Ç–æ–≤–æ –¥–æ —Ñ–æ—Ç–æ</div>
    </div>
    
    <canvas id="canvas" style="display: none;"></canvas>
    
    <!-- –ü–æ–ø–∞–ø (—ñ—Å–Ω—É—é—á–∏–π) -->
    <div id="words-popup" class="popup-overlay" style="display: none;">
        <div class="popup-content">
            <div class="popup-header">
                <h3>Select words</h3>
            </div>
            <div class="popup-body">
                <div id="popup-word-chips" class="word-chips"></div>
                <div class="popup-actions">
                    <button id="popup-save" class="btn btn-primary btn-full" disabled>–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                    <button id="popup-back" class="btn btn-secondary btn-full">–ù–∞–∑–∞–¥</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tesseract.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    
    <!-- –¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç -->
    <script>
        console.log('=== –¢–ï–°–¢–û–í–ò–ô –°–ö–†–ò–ü–¢ ===');
        
        // –¢–µ—Å—Ç—É—î–º–æ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ');
            
            const captureBtn = document.getElementById('capture');
            const cameraInput = document.getElementById('camera-input');
            
            console.log('Capture button:', captureBtn);
            console.log('Camera input:', cameraInput);
            
            if (captureBtn) {
                console.log('–î–æ–¥–∞—î–º–æ event listener –¥–æ –∫–Ω–æ–ø–∫–∏');
                
                // –î–æ–¥–∞—î–º–æ —â–µ –æ–¥–∏–Ω event listener
                captureBtn.addEventListener('click', function(e) {
                    console.log('EVENT LISTENER –°–ü–†–ê–¶–Æ–í–ê–í!');
                    console.log('Event:', e);
                    
                    if (cameraInput) {
                        console.log('–í–∏–∫–ª–∏–∫–∞—î–º–æ click –Ω–∞ input');
                        cameraInput.click();
                    } else {
                        console.error('Camera input –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
                    }
                });
                
                // –¢–µ—Å—Ç—É—î–º–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ
                captureBtn.onclick = function() {
                    console.log('ONCLICK –°–ü–†–ê–¶–Æ–í–ê–í!');
                    if (cameraInput) {
                        cameraInput.click();
                    }
                };
            }
            
            if (cameraInput) {
                cameraInput.addEventListener('change', function(e) {
                    console.log('FILE INPUT CHANGE!', e.target.files);
                    if (e.target.files[0]) {
                        alert('–§–∞–π–ª –æ–±—Ä–∞–Ω–æ: ' + e.target.files[0].name);
                    }
                });
            }
        });
    </script>
    
    <!-- –ù–∞—à—ñ —Å–∫—Ä–∏–ø—Ç–∏ -->
    <script src="camera.js"></script>
    <script src="ocr.js"></script>
    <script src="text.js"></script>
    <script src="database.js"></script>
</body>
</html>
